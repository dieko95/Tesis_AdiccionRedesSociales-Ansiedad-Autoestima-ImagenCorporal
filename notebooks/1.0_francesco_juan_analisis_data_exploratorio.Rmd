---
title: "1.0_francesco_juan_analisis_data_exploratorio"
output: html_document
date: '2022-10-04'
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

#read Data

```{r}
library(readr)
library(readxl)
library(dplyr)
library(skimr)
library(dlookr) 
library(inspectdf) 
library(stringr)
library(ggplot2)
library(caret)
library(ggiraphExtra)
library(rcompanion)
library(naniar)
library(showtext)

#Leer data
original_df <- read_delim("../data/raw/Data para R.csv", 
                          ";", escape_double = FALSE, locale = locale(decimal_mark = ","), 
                          trim_ws = TRUE)

View(original_df)
```

#recodificacion de datos

```{r}
#Convertir respuestas erroneas a NA
  
 original_df[1, 15:27] <- NA 
 original_df[84, 15:27] <- NA

 #convertir valores NA a 0
  
  original_df[is.na(original_df)] <- "no valido"
  
  #convertir a factor
  
original_df[,3:27] <- lapply(original_df[,3:27], as.factor)
```

#total encuestados y porcentajes

```{r}

  muestra <- 423

  #Variable de exclusion 1: edad 18-25
  muestra_edad <- 394
  porcentaje_exclu1 <- ((muestra - muestra_edad)/muestra)*100 
  porcentaje_exclu1

  #Variable de exclusion 2: estudiando
  muestra_carrera <- 354
  porcentaje_exclu2 <- ((muestra_edad - muestra_carrera)/muestra_edad)*100
  porcentaje_exclu2

  #Variable de exclusion 3: residencia Municipios
  muestra_mun <- 334
  porcentaje_exclu3 <- ((muestra_carrera - muestra_mun)/muestra_carrera)*100
  porcentaje_exclu3

  #Variable de exclusion 4: diagnostico clinico
  muestra_dx <- 261
  porcentaje_exclu4 <- ((muestra_mun - muestra_dx)/muestra_mun)*100
  porcentaje_exclu4
  
  #Muestra final
  length(original_df$id)
  
```

#valores nulos

```{r}
#Valores nulos
  
  original_df %>%
    is.na() %>%
    sum()

vis_miss(original_df, sort_miss = TRUE)
  
  View(original_df)
  
  
```

#outlyiers de factores adiccion a las redes sociales

```{r}
  
    #ADICCION A LAS REDES SOCIALES
  
      #ARS fac 1
  
      original_df %>% 
        ggplot(aes(y = original_df$fac1_ars)) +
        labs(x= "Encuestados", y= "Frecuencia de Factor 1 ars", title = "Adicción Redes Sociales", subtitle = "Frecuencia del Factor 1") +
        geom_boxplot()
  
  
      #ARS fac 2
  
      original_df %>% 
        ggplot(aes(y = original_df$fac2_ars)) +
        labs(x= "Encuestados", y= "Frecuencia de Factor 2 ars", title = "Adicción Redes Sociales", subtitle = "Frecuencia del Factor 2") +
        geom_boxplot()
  
      #ARS fac 3 
  
      original_df %>% 
      ggplot(aes(y = original_df$fac3_ars)) +
       labs(x= "Encuestados", y= "Frecuencia de Factor 3 ars", title = "Adicción Redes Sociales", subtitle = "Frecuencia del Factor 3") +
      geom_boxplot()
  

```

#outlyiers de factores Autoestima

```{r}
#AUTOESTIMA
  
      #Auto fac 1
      original_df %>% 
      ggplot(aes(y = original_df$fac1_auto)) +
        labs(x= "Encuestados", y= "Frecuencia de Factor 1 Autoestima", title = "Autoestima", subtitle = "Frecuencia del Factor 1") +
      geom_boxplot()
      
      #Auto fac 2
      original_df %>% 
      ggplot(aes(y = original_df$fac2_auto)) +
        labs(x= "Encuestados", y= "Frecuencia de Factor 2 Autoestima", title = "Autoestima", subtitle = "Frecuencia del Factor 2") +
      geom_boxplot()
```

#outlyiers de factores BSQ

```{r}
      #BSQ fac 1
      original_df %>% 
      ggplot(aes(y = original_df$fac1_bsq)) +
        labs(x= "Encuestados", y= "Frecuencia de Factor 1 BSQ", title = "Body Shape Questionnaire", subtitle = "Frecuencia del Factor 1") +
      geom_boxplot()
 
      #BSQ fac 2
      original_df %>% 
      ggplot(aes(y = original_df$fac2_bsq)) +
        labs(x= "Encuestados", y= "Frecuencia de Factor 2 BSQ", title = "Body Shape Questionnaire", subtitle = "Frecuencia del Factor 2") +
      geom_boxplot()
      
      #BSQ fac 3
      original_df %>% 
        ggplot(aes(y = original_df$fac3_bsq)) +
        labs(x= "Encuestados", y= "Frecuencia de Factor 3 BSQ", title = "Body Shape Questionnaire", subtitle = "Frecuencia del Factor 3") +
        geom_boxplot()
```

#analisis descriptivo municipio

```{r}
original_df %>% 
  count(municipio) %>% 
  mutate(pct = prop.table(n))
```

```{r}
#municipio

original_df %>% 
  count(municipio) %>% # Contar sujetos por municipio
  mutate(pct = prop.table(n)) %>% # Crear Porcentajes
  ggplot(aes(x=municipio, y= n, fill = municipio, label = scales::percent(pct))) +
    geom_col(binwidth = 0.5, stat = "count", colour = "black", linetype = 1) + 
    labs(x= "Municipios", y= "Frecuencia", title = "Muncipios Encuestados", subtitle = "Cantidad de personas por municipio") +
    guides(fill = guide_legend(title = "Municipios"),
           colour = guide_legend(title = "Municipio")) + 
    geom_text(position = position_dodge(width = .9),    # Mover al centro de las barras
              vjust = -0.5,    # Mover al tope de las barras
              size = 3)

#Chi Cuadrado Municipio
  
chisq.test(table(original_df$municipio))

```

#analisis descriptivo univariante sexo

```{r}
#Sexo

original_df %>% 
  count(sexo) %>% # Contar sujetos por municipio
  mutate(pct = prop.table(n)) %>% # Crear Porcentajes
  ggplot(aes(x=sexo, y= n, fill = sexo, label = scales::percent(pct))) +
    geom_col(binwidth = 0.5, stat = "count", colour = "black", linetype = 1) + 
    labs(x= "Sexo", y= "Frecuencia", title = "Sexo", subtitle = "Frecuencia de identificacion de sexo de los encuestados") +
    guides(fill = guide_legend(title = "Sexo"),
           colour = guide_legend(title = "Sexo")) + 
    geom_text(position = position_dodge(width = .9),    # Mover al centro de las barras
              vjust = -0.5,    # Mover al tope de las barras
              size = 3)
  
  #Chi Cuadrado Sexo

chisq.test(table(original_df$sexo))
```

#analisis descriptivo univariante edad

```{r}
#Edad

original_df %>% 
  count(edad) %>% # Contar sujetos por municipio
  mutate(pct = prop.table(n)) %>% # Crear Porcentajes
  ggplot(aes(x=edad, y= n, fill = edad, label = scales::percent(pct))) +
    geom_col(binwidth = 0.5, stat = "count", colour = "black", linetype = 1) + 
    labs(x= "Edad", y= "Frecuencia", title = "Edades de los encuestados", subtitle = "Frecuencia de edades de los encuestados") +
    guides(fill = guide_legend(title = "Edades"),
           colour = guide_legend(title = "Edad")) + 
    geom_text(position = position_dodge(width = .9),    # Mover al centro de las barras
              vjust = -0.5,    # Mover al tope de las barras
              size = 3)
```

#analisis descriptivo univariante tipo de dispositivo

```{r}
#Tipo de dispositivo

original_df %>% 
  count(tipo_dispositivo_rrss) %>% # Contar sujetos por municipio
  mutate(pct = prop.table(n)) %>% # Crear Porcentajes
  ggplot(aes(x=tipo_dispositivo_rrss, y= n, fill = tipo_dispositivo_rrss, label = scales::percent(pct))) +
    geom_col(binwidth = 0.5, stat = "count", colour = "black", linetype = 1) + 
    labs(x= "Tipo de dispositivo para ingresar a RRSS", y= "Frecuencia", title = "Tipo de dispositivo", subtitle = "Dispositivos mas frecuentes para ingresar a Redes Sociales") +
    guides(fill = guide_legend(title = "Tipos de dispositivos"),
           colour = guide_legend(title = "Tipos de dispositivos")) + 
    geom_text(position = position_dodge(width = .9),    # Mover al centro de las barras
              vjust = -0.5,    # Mover al tope de las barras
              size = 3)
```

#analisis descriptivo bivariante fact 2 vs tipo de dispositivo

```{r}
original_df%>%
  ggplot(aes(x = tipo_dispositivo_rrss, y = fac2_ars)) +
  geom_violin() + 
  stat_summary(fun = "mean",
               geom = "point",
               aes(color = "Mean")) +
  stat_summary(fun = "median",
               geom = "point",
               aes(color = "Median")) +
 scale_colour_manual(values = c("red", "blue")) 
# aes(x= "Tipo de Dispositivo", y= "Factor 2 Adiccion Redes Sociales")
```

#analisis descriptivo bivariante fact 3 vs tipo de dispositivo

```{r}
original_df%>%
  ggplot(aes(x = tipo_dispositivo_rrss, y =fac3_ars)) +
  geom_violin() + 
  stat_summary(fun = "mean",
               geom = "point",
               aes(color = "Mean")) +
  stat_summary(fun = "median",
               geom = "point",
               aes(color = "Median")) +
 scale_colour_manual(values = c("red", "blue")) 
# aes(x= "Tipo de Dispositivo", y= "Factor 3 Adiccion Redes Sociales")
```

#analisis univariante ocupacion

```{r}
original_df %>% 
  count(trabajo_actual) %>% # Contar sujetos por municipio
  mutate(pct = prop.table(n)) %>% # Crear Porcentajes
  ggplot(aes(x=trabajo_actual, y= n, fill = trabajo_actual, label = scales::percent(pct))) +
    geom_col(binwidth = 0.5, stat = "count", colour = "black", linetype = 1) + 
    labs(x= "Ocupacion", y= "Frecuencia", title = "Ocupacion", subtitle = "Frecuencia de ocupacion de los encuestados") +
    guides(fill = guide_legend(title = "Ocupacion"),
           colour = guide_legend(title = "Ocupacion")) + 
    geom_text(position = position_dodge(width = .9),    # Mover al centro de las barras
              vjust = -0.5,    # Mover al tope de las barras
              size = 3)
```

#analisis descriptivo bivariante fact 1 vs ocupacion

```{r}
original_df%>%
  ggplot(aes(x = trabajo_actual, y =  fac1_ars)) +
  geom_violin() + 
  stat_summary(fun = "mean",
               geom = "point",
               aes(color = "Mean")) +
  stat_summary(fun = "median",
               geom = "point",
               aes(color = "Median")) +
 scale_colour_manual(values = c("red", "blue"))  
  #aes(x= "Ocupacion", y= "Factor 1 Redes Sociales")
```

#analisis descriptivo bivariante fact 2 vs ocupacion

```{r}
original_df%>%
  ggplot(aes(x = trabajo_actual, y =  fac2_ars)) +
  geom_violin() + 
  stat_summary(fun = "mean",
               geom = "point",
               aes(color = "Mean")) +
  stat_summary(fun = "median",
               geom = "point",
               aes(color = "Median")) +
 scale_colour_manual(values = c("red", "blue"))  
  #aes(x= "Ocupacion", y= "Factor 2 Redes Sociales")
```

#analisis descriptivo bivariante fact 3 vs ocupacion

```{r}
original_df%>%
  ggplot(aes(x = trabajo_actual, y =  fac3_ars)) +
  geom_violin() + 
  stat_summary(fun = "mean",
               geom = "point",
               aes(color = "Mean")) +
  stat_summary(fun = "median",
               geom = "point",
               aes(color = "Median")) +
 scale_colour_manual(values = c("red", "blue"))  
  #aes(x= "Ocupacion", y= "Factor 2 Redes Sociales")
```

#nivel educativo

```{r}
original_df %>% 
  count(educación) %>% # Contar sujetos por municipio
  mutate(pct = prop.table(n)) %>% # Crear Porcentajes
  ggplot(aes(x=educación, y= n, fill = educación, label = scales::percent(pct))) +
    geom_col(binwidth = 0.5, stat = "count", colour = "black", linetype = 1) + 
    labs(x= "Nivel Educativo", y= "Frecuencia", title = "Nivel Educativo", subtitle = "Frecuencia de nivel educativo") +
    guides(fill = guide_legend(title = "Nivel Educativo"),
           colour = guide_legend(title = "Nivel Educativo")) + 
    geom_text(position = position_dodge(width = .9),    # Mover al centro de las barras
              vjust = -0.5,    # Mover al tope de las barras
              size = 3)
```

#INTERNET FIJO

#analisis univariante y bivariante variable control internet fijo

```{r}
original_df %>% 
  count(internet_fijo) %>% # Contar sujetos por municipio
  mutate(pct = prop.table(n)) %>% # Crear Porcentajes
  ggplot(aes(x=internet_fijo, y= n, fill = internet_fijo, label = scales::percent(pct))) +
    geom_col(binwidth = 0.5, stat = "count", colour = "black", linetype = 1) + 
    labs(x= "Internet Fijo", y= "Frecuencia", title = "Internet Fijo", subtitle = "Frecuencia de acceso a internet fijo") +
    guides(fill = guide_legend(title = "Internet fijo"),
           colour = guide_legend(title = "Internet fijo")) + 
    geom_text(position = position_dodge(width = .9),    # Mover al centro de las barras
              vjust = -0.5,    # Mover al tope de las barras
              size = 3)
original_df%>%
  ggplot(aes(x = internet_fijo, y =  fac1_ars)) +
  geom_violin() + 
  stat_summary(fun = "mean",
               geom = "point",
               aes(color = "Mean")) +
  stat_summary(fun = "median",
               geom = "point",
               aes(color = "Median")) +
 scale_colour_manual(values = c("red", "blue"))  
  #aes(x= "Ocupacion", y= "Factor 1 Redes Sociales")

original_df%>%
  ggplot(aes(x = internet_fijo, y =  fac2_ars)) +
  geom_violin() + 
  stat_summary(fun = "mean",
               geom = "point",
               aes(color = "Mean")) +
  stat_summary(fun = "median",
               geom = "point",
               aes(color = "Median")) +
 scale_colour_manual(values = c("red", "blue"))  
  #aes(x= "Ocupacion", y= "Factor 1 Redes Sociales")

original_df%>%
  ggplot(aes(x = internet_fijo, y =  fac3_ars)) +
  geom_violin() + 
  stat_summary(fun = "mean",
               geom = "point",
               aes(color = "Mean")) +
  stat_summary(fun = "median",
               geom = "point",
               aes(color = "Median")) +
 scale_colour_manual(values = c("red", "blue"))  
  #aes(x= "Ocupacion", y= "Factor 1 Redes Sociales")
```

#analisis univariante y bivariante calidad de conectividad

```{r}
original_df %>% 
  count(calidad_internet_fijo) %>% # Contar sujetos por municipio
  mutate(pct = prop.table(n)) %>% # Crear Porcentajes
  ggplot(aes(x=calidad_internet_fijo, y= n, fill = calidad_internet_fijo, label = scales::percent(pct))) +
    geom_col(binwidth = 0.5, stat = "count", colour = "black", linetype = 1) + 
    labs(x= "Calidad de internet fijo", y= "Frecuencia", title = "Calidad de internet", subtitle = "Calidad de servicio de internet fijo de los encuestados") +
    guides(fill = guide_legend(title = "Calidad de internet"),
           colour = guide_legend(title = "Calidad de internet")) + 
    geom_text(position = position_dodge(width = .9),    # Mover al centro de las barras
              vjust = -0.5,    # Mover al tope de las barras
              size = 3)

original_df%>%
  ggplot(aes(x = calidad_internet_fijo, y =  fac1_ars)) +
  geom_violin() + 
  stat_summary(fun = "mean",
               geom = "point",
               aes(color = "Mean")) +
  stat_summary(fun = "median",
               geom = "point",
               aes(color = "Median")) +
 scale_colour_manual(values = c("red", "blue"))  
  #aes(x= "Ocupacion", y= "Factor 1 Redes Sociales")

original_df%>%
  ggplot(aes(x = calidad_internet_fijo, y =  fac2_ars)) +
  geom_violin() + 
  stat_summary(fun = "mean",
               geom = "point",
               aes(color = "Mean")) +
  stat_summary(fun = "median",
               geom = "point",
               aes(color = "Median")) +
 scale_colour_manual(values = c("red", "blue"))  
  #aes(x= "Ocupacion", y= "Factor 1 Redes Sociales")

original_df%>%
  ggplot(aes(x = calidad_internet_fijo, y =  fac3_ars)) +
  geom_violin() + 
  stat_summary(fun = "mean",
               geom = "point",
               aes(color = "Mean")) +
  stat_summary(fun = "median",
               geom = "point",
               aes(color = "Median")) +
 scale_colour_manual(values = c("red", "blue"))  
  #aes(x= "Ocupacion", y= "Factor 1 Redes Sociales")
```

#analisis univariante y bivariante variable control fallas de servicio

```{r}
original_df %>% 
  count(fallas_servicio) %>% # Contar sujetos por municipio
  mutate(pct = prop.table(n)) %>% # Crear Porcentajes
  ggplot(aes(x=fallas_servicio, y= n, fill = fallas_servicio, label = scales::percent(pct))) +
    geom_col(binwidth = 0.5, stat = "count", colour = "black", linetype = 1) + 
    labs(x= "Fallas del servicio fijo", y= "Frecuencia", title = "Fallas del servicio fijo", subtitle = "Frecuencia de fallas presentadas sobre el servicio fijo de internet") +
    guides(fill = guide_legend(title = "Fallas del servicio fijo"),
           colour = guide_legend(title = "Fallas del servicio fijo")) + 
    geom_text(position = position_dodge(width = .9),    # Mover al centro de las barras
              vjust = -0.5,    # Mover al tope de las barras
              size = 3)

original_df%>%
  ggplot(aes(x = fallas_servicio, y =  fac1_ars)) +
  geom_violin() + 
  stat_summary(fun = "mean",
               geom = "point",
               aes(color = "Mean")) +
  stat_summary(fun = "median",
               geom = "point",
               aes(color = "Median")) +
 scale_colour_manual(values = c("red", "blue"))  
  #aes(x= "Ocupacion", y= "Factor 1 Redes Sociales")

original_df%>%
  ggplot(aes(x = fallas_servicio, y =  fac2_ars)) +
  geom_violin() + 
  stat_summary(fun = "mean",
               geom = "point",
               aes(color = "Mean")) +
  stat_summary(fun = "median",
               geom = "point",
               aes(color = "Median")) +
 scale_colour_manual(values = c("red", "blue"))  
  #aes(x= "Ocupacion", y= "Factor 1 Redes Sociales")

original_df%>%
  ggplot(aes(x = fallas_servicio, y =  fac3_ars)) +
  geom_violin() + 
  stat_summary(fun = "mean",
               geom = "point",
               aes(color = "Mean")) +
  stat_summary(fun = "median",
               geom = "point",
               aes(color = "Median")) +
 scale_colour_manual(values = c("red", "blue"))  
  #aes(x= "Ocupacion", y= "Factor 1 Redes Sociales")


```

#analisis univariante y bivariante variable control percepcion positiva del servicio

```{r}
original_df %>% 
  count(internet_fijo_positivo) %>% # Contar sujetos por municipio
  mutate(pct = prop.table(n)) %>% # Crear Porcentajes
  ggplot(aes(x=internet_fijo_positivo, y= n, fill = internet_fijo_positivo, label = scales::percent(pct))) +
    geom_col(binwidth = 0.5, stat = "count", colour = "black", linetype = 1) + 
    labs(x= "Percepcion positiva del servicio", y= "Frecuencia", title = "Percepcion positiva del servicio", subtitle = "Frecuencia de la percepcion del servicio fijo") +
    guides(fill = guide_legend(title = "Percepcion positiva del servicio"),
           colour = guide_legend(title = "Percepcion positiva del servicio")) + 
    geom_text(position = position_dodge(width = .9),    # Mover al centro de las barras
              vjust = -0.5,    # Mover al tope de las barras
              size = 3)

original_df%>%
  ggplot(aes(x = internet_fijo_positivo, y =  fac1_ars)) +
  geom_violin() + 
  stat_summary(fun = "mean",
               geom = "point",
               aes(color = "Mean")) +
  stat_summary(fun = "median",
               geom = "point",
               aes(color = "Median")) +
 scale_colour_manual(values = c("red", "blue"))  
  #aes(x= "Ocupacion", y= "Factor 1 Redes Sociales")

original_df%>%
  ggplot(aes(x = internet_fijo_positivo, y =  fac2_ars)) +
  geom_violin() + 
  stat_summary(fun = "mean",
               geom = "point",
               aes(color = "Mean")) +
  stat_summary(fun = "median",
               geom = "point",
               aes(color = "Median")) +
 scale_colour_manual(values = c("red", "blue"))  
  #aes(x= "Ocupacion", y= "Factor 1 Redes Sociales")

original_df%>%
  ggplot(aes(x = internet_fijo_positivo, y =  fac3_ars)) +
  geom_violin() + 
  stat_summary(fun = "mean",
               geom = "point",
               aes(color = "Mean")) +
  stat_summary(fun = "median",
               geom = "point",
               aes(color = "Median")) +
 scale_colour_manual(values = c("red", "blue"))  
  #aes(x= "Ocupacion", y= "Factor 1 Redes Sociales")

```

#analisis univariante y bivariante variable control percepcion negativa del servicio

```{r}
original_df %>% 
  count(internet_fijo_negativo) %>% # Contar sujetos por municipio
  mutate(pct = prop.table(n)) %>% # Crear Porcentajes
  ggplot(aes(x=internet_fijo_negativo, y= n, fill = internet_fijo_negativo, label = scales::percent(pct))) +
    geom_col(binwidth = 0.5, stat = "count", colour = "black", linetype = 1) + 
    labs(x= "Percepcion negativa del servicio", y= "Frecuencia", title = "Percepcion negativa del servicio", subtitle = "Frecuencia de la percepcion del negativa fijo") +
    guides(fill = guide_legend(title = "Percepcion negativa del servicio"),
           colour = guide_legend(title = "Percepcion negativa del servicio")) + 
    geom_text(position = position_dodge(width = .9),    # Mover al centro de las barras
              vjust = -0.5,    # Mover al tope de las barras
              size = 3)

original_df%>%
  ggplot(aes(x = internet_fijo_negativo, y =  fac1_ars)) +
  geom_violin() + 
  stat_summary(fun = "mean",
               geom = "point",
               aes(color = "Mean")) +
  stat_summary(fun = "median",
               geom = "point",
               aes(color = "Median")) +
 scale_colour_manual(values = c("red", "blue"))  
  #aes(x= "Ocupacion", y= "Factor 1 Redes Sociales")

original_df%>%
  ggplot(aes(x = internet_fijo_negativo, y =  fac2_ars)) +
  geom_violin() + 
  stat_summary(fun = "mean",
               geom = "point",
               aes(color = "Mean")) +
  stat_summary(fun = "median",
               geom = "point",
               aes(color = "Median")) +
 scale_colour_manual(values = c("red", "blue"))  
  #aes(x= "Ocupacion", y= "Factor 1 Redes Sociales")

original_df%>%
  ggplot(aes(x = internet_fijo_negativo, y =  fac3_ars)) +
  geom_violin() + 
  stat_summary(fun = "mean",
               geom = "point",
               aes(color = "Mean")) +
  stat_summary(fun = "median",
               geom = "point",
               aes(color = "Median")) +
 scale_colour_manual(values = c("red", "blue"))  
  #aes(x= "Ocupacion", y= "Factor 1 Redes Sociales")
```

#analisis univariante y bivariante reestablecimiento del servicio de internet

```{r}


original_df%>%
  ggplot(aes(x = fallo_internet_reestablecimiento, y =  fac1_ars)) +
  geom_violin() + 
  stat_summary(fun = "mean",
               geom = "point",
               aes(color = "Mean")) +
  stat_summary(fun = "median",
               geom = "point",
               aes(color = "Median")) +
 scale_colour_manual(values = c("red", "blue"))  
  #aes(x= "Ocupacion", y= "Factor 1 Redes Sociales")

original_df%>%
  ggplot(aes(x = fallo_internet_reestablecimiento, y =  fac2_ars)) +
  geom_violin() + 
  stat_summary(fun = "mean",
               geom = "point",
               aes(color = "Mean")) +
  stat_summary(fun = "median",
               geom = "point",
               aes(color = "Median")) +
 scale_colour_manual(values = c("red", "blue"))  
  #aes(x= "Ocupacion", y= "Factor 1 Redes Sociales")

original_df%>%
  ggplot(aes(x = fallo_internet_reestablecimiento, y =  fac3_ars)) +
  geom_violin() + 
  stat_summary(fun = "mean",
               geom = "point",
               aes(color = "Mean")) +
  stat_summary(fun = "median",
               geom = "point",
               aes(color = "Median")) +
 scale_colour_manual(values = c("red", "blue"))  
  #aes(x= "Ocupacion", y= "Factor 1 Redes Sociales")
```

#analisis univariante y bivariante tipo de empresa

```{r}
original_df %>% 
  count(tipo_empresa_internet_fijo) %>% # Contar sujetos por municipio
  mutate(pct = prop.table(n)) %>% # Crear Porcentajes
  ggplot(aes(x=tipo_empresa_internet_fijo, y= n, fill = tipo_empresa_internet_fijo, label = scales::percent(pct))) +
    geom_col(binwidth = 0.5, stat = "count", colour = "black", linetype = 1) + 
    labs(x= "Tipo de empresa de servicio fijo", y= "Frecuencia", title = "Tipo de empresa de servicio fijo", subtitle = "Frecuencia empresas de servicio de internet fijo") +
    guides(fill = guide_legend(title = "Tipo de empresa servicio fijo"),
           colour = guide_legend(title = "Tipo de empresa servicio fijo")) + 
    geom_text(position = position_dodge(width = .9),    # Mover al centro de las barras
              vjust = -0.5,    # Mover al tope de las barras
              size = 3)

original_df%>%
  ggplot(aes(x = tipo_empresa_internet_fijo, y =  fac1_ars)) +
  geom_violin() + 
  stat_summary(fun = "mean",
               geom = "point",
               aes(color = "Mean")) +
  stat_summary(fun = "median",
               geom = "point",
               aes(color = "Median")) +
 scale_colour_manual(values = c("red", "blue"))  
  #aes(x= "Ocupacion", y= "Factor 1 Redes Sociales")

original_df%>%
  ggplot(aes(x = tipo_empresa_internet_fijo, y =  fac2_ars)) +
  geom_violin() + 
  stat_summary(fun = "mean",
               geom = "point",
               aes(color = "Mean")) +
  stat_summary(fun = "median",
               geom = "point",
               aes(color = "Median")) +
 scale_colour_manual(values = c("red", "blue"))  
  #aes(x= "Ocupacion", y= "Factor 1 Redes Sociales")

original_df%>%
  ggplot(aes(x = tipo_empresa_internet_fijo, y =  fac3_ars)) +
  geom_violin() + 
  stat_summary(fun = "mean",
               geom = "point",
               aes(color = "Mean")) +
  stat_summary(fun = "median",
               geom = "point",
               aes(color = "Median")) +
 scale_colour_manual(values = c("red", "blue"))  
  #aes(x= "Ocupacion", y= "Factor 1 Redes Sociales")
```

#analisis univariante y bivariante cambio de proveedor

```{r}
original_df %>% 
  count(cambio_proveedor_reciente) %>% # Contar sujetos por municipio
  mutate(pct = prop.table(n)) %>% # Crear Porcentajes
  ggplot(aes(x=cambio_proveedor_reciente, y= n, fill = cambio_proveedor_reciente, label = scales::percent(pct))) +
    geom_col(binwidth = 0.5, stat = "count", colour = "black", linetype = 1) + 
    labs(x= "Cambio reciente de proveedor", y= "Frecuencia", title = "Cambio de proveedor", subtitle = "Frecuencia de cambio de proveedor de servicio fijo de internet") +
    guides(fill = guide_legend(title = "Cambio de proveedor"),
           colour = guide_legend(title = "Cambio de proveedor")) + 
    geom_text(position = position_dodge(width = .9),    # Mover al centro de las barras
              vjust = -0.5,    # Mover al tope de las barras
              size = 3)


original_df%>%
  ggplot(aes(x = cambio_proveedor_reciente, y =  fac1_ars)) +
  geom_violin() + 
  stat_summary(fun = "mean",
               geom = "point",
               aes(color = "Mean")) +
  stat_summary(fun = "median",
               geom = "point",
               aes(color = "Median")) +
 scale_colour_manual(values = c("red", "blue"))  
  #aes(x= "Ocupacion", y= "Factor 1 Redes Sociales")

original_df%>%
  ggplot(aes(x = cambio_proveedor_reciente, y =  fac2_ars)) +
  geom_violin() + 
  stat_summary(fun = "mean",
               geom = "point",
               aes(color = "Mean")) +
  stat_summary(fun = "median",
               geom = "point",
               aes(color = "Median")) +
 scale_colour_manual(values = c("red", "blue"))  
  #aes(x= "Ocupacion", y= "Factor 1 Redes Sociales")

original_df%>%
  ggplot(aes(x = cambio_proveedor_reciente, y =  fac3_ars)) +
  geom_violin() + 
  stat_summary(fun = "mean",
               geom = "point",
               aes(color = "Mean")) +
  stat_summary(fun = "median",
               geom = "point",
               aes(color = "Median")) +
 scale_colour_manual(values = c("red", "blue"))  
  #aes(x= "Ocupacion", y= "Factor 1 Redes Sociales")
```

#analisis descriptivo univariante y bivariante medida secundaria

```{r}
original_df %>% 
  count(medida_secundaria_fallo_internet_fijo) %>% # Contar sujetos por municipio
  mutate(pct = prop.table(n)) %>% # Crear Porcentajes
  ggplot(aes(x=medida_secundaria_fallo_internet_fijo, y= n, fill = medida_secundaria_fallo_internet_fijo, label = scales::percent(pct))) +
    geom_col(binwidth = 0.5, stat = "count", colour = "black", linetype = 1) + 
    labs(x= "Medida alterna frente frente a fallas", y= "Frecuencia", title = "Medidada alterna a fallas del servicio fijo", subtitle = "Medida secundaria frente a fallas presentadas por el servicio dijo de internet") +
    guides(fill = guide_legend(title = "Medida alterna"),
           colour = guide_legend(title = "Medida alterna")) + 
    geom_text(position = position_dodge(width = .9),    # Mover al centro de las barras
              vjust = -0.5,    # Mover al tope de las barras
              size = 3)


original_df%>%
  ggplot(aes(x = medida_secundaria_fallo_internet_fijo, y =  fac1_ars)) +
  geom_violin() + 
  stat_summary(fun = "mean",
               geom = "point",
               aes(color = "Mean")) +
  stat_summary(fun = "median",
               geom = "point",
               aes(color = "Median")) +
 scale_colour_manual(values = c("red", "blue"))  
  #aes(x= "Ocupacion", y= "Factor 1 Redes Sociales")

original_df%>%
  ggplot(aes(x = medida_secundaria_fallo_internet_fijo, y =  fac2_ars)) +
  geom_violin() + 
  stat_summary(fun = "mean",
               geom = "point",
               aes(color = "Mean")) +
  stat_summary(fun = "median",
               geom = "point",
               aes(color = "Median")) +
 scale_colour_manual(values = c("red", "blue"))  
  #aes(x= "Ocupacion", y= "Factor 1 Redes Sociales")

original_df%>%
  ggplot(aes(x = medida_secundaria_fallo_internet_fijo, y =  fac3_ars)) +
  geom_violin() + 
  stat_summary(fun = "mean",
               geom = "point",
               aes(color = "Mean")) +
  stat_summary(fun = "median",
               geom = "point",
               aes(color = "Median")) +
 scale_colour_manual(values = c("red", "blue"))  
  #aes(x= "Ocupacion", y= "Factor 1 Redes Sociales")
```

#analisis univariante y bivariante pago de internet

```{r}
original_df %>% 
  count(pago_internet_dolares) %>% # Contar sujetos por municipio
  mutate(pct = prop.table(n)) %>% # Crear Porcentajes
  ggplot(aes(x=pago_internet_dolares, y= n, fill = pago_internet_dolares, label = scales::percent(pct))) +
    geom_col(binwidth = 0.5, stat = "count", colour = "black", linetype = 1) + 
    labs(x= "Pago en divisas", y= "Frecuencia", title = "Pago de servicio fijo en divisas", subtitle = "Frecuencia de pago en divisas de servicios de internet fijo") +
    guides(fill = guide_legend(title = "Pago en divisas"),
           colour = guide_legend(title = "Pago en divisas")) + 
    geom_text(position = position_dodge(width = .9),    # Mover al centro de las barras
              vjust = -0.5,    # Mover al tope de las barras
              size = 3)


original_df%>%
  ggplot(aes(x = pago_internet_dolares, y =  fac1_ars)) +
  geom_violin() + 
  stat_summary(fun = "mean",
               geom = "point",
               aes(color = "Mean")) +
  stat_summary(fun = "median",
               geom = "point",
               aes(color = "Median")) +
 scale_colour_manual(values = c("red", "blue"))  
  #aes(x= "Ocupacion", y= "Factor 1 Redes Sociales")

original_df%>%
  ggplot(aes(x = pago_internet_dolares, y =  fac2_ars)) +
  geom_violin() + 
  stat_summary(fun = "mean",
               geom = "point",
               aes(color = "Mean")) +
  stat_summary(fun = "median",
               geom = "point",
               aes(color = "Median")) +
 scale_colour_manual(values = c("red", "blue"))  
  #aes(x= "Ocupacion", y= "Factor 1 Redes Sociales")

original_df%>%
  ggplot(aes(x = pago_internet_dolares, y =  fac3_ars)) +
  geom_violin() + 
  stat_summary(fun = "mean",
               geom = "point",
               aes(color = "Mean")) +
  stat_summary(fun = "median",
               geom = "point",
               aes(color = "Median")) +
 scale_colour_manual(values = c("red", "blue"))  
  #aes(x= "Ocupacion", y= "Factor 1 Redes Sociales")
```

#INTERNET MOVIL

#analisis descriptivo acceso rrss via movil

```{r}
original_df %>% 
  count(acceso_celular_rrss) %>% # Contar sujetos por municipio
  mutate(pct = prop.table(n)) %>% # Crear Porcentajes
  ggplot(aes(x=acceso_celular_rrss, y= n, fill = acceso_celular_rrss, label = scales::percent(pct))) +
    geom_col(binwidth = 0.5, stat = "count", colour = "black", linetype = 1) + 
    labs(x= "Acceso a redes sociales via movil", y= "Frecuencia", title = "Acceso a redes sociales via movil", subtitle = "Frecuencia de acceso a redes sociales via movil") +
    guides(fill = guide_legend(title = "Acceso a rrss via movil"),
           colour = guide_legend(title = "Acceso a rrss via movil")) + 
    geom_text(position = position_dodge(width = .9),    # Mover al centro de las barras
              vjust = -0.5,    # Mover al tope de las barras
              size = 3)

original_df%>%
  ggplot(aes(x = acceso_celular_rrss, y =  fac1_ars)) +
  geom_violin() + 
  stat_summary(fun = "mean",
               geom = "point",
               aes(color = "Mean")) +
  stat_summary(fun = "median",
               geom = "point",
               aes(color = "Median")) +
 scale_colour_manual(values = c("red", "blue"))  
  #aes(x= "Ocupacion", y= "Factor 1 Redes Sociales")

original_df%>%
  ggplot(aes(x = acceso_celular_rrss, y =  fac2_ars)) +
  geom_violin() + 
  stat_summary(fun = "mean",
               geom = "point",
               aes(color = "Mean")) +
  stat_summary(fun = "median",
               geom = "point",
               aes(color = "Median")) +
 scale_colour_manual(values = c("red", "blue"))  
  #aes(x= "Ocupacion", y= "Factor 1 Redes Sociales")

original_df%>%
  ggplot(aes(x = acceso_celular_rrss, y =  fac3_ars)) +
  geom_violin() + 
  stat_summary(fun = "mean",
               geom = "point",
               aes(color = "Mean")) +
  stat_summary(fun = "median",
               geom = "point",
               aes(color = "Median")) +
 scale_colour_manual(values = c("red", "blue"))  
  #aes(x= "Ocupacion", y= "Factor 1 Redes Sociales")
```

#analisis univariante de calidad de conexion movil

```{r}
original_df %>% 
  count(calidad_navegacion_movil) %>% # Contar sujetos por municipio
  mutate(pct = prop.table(n)) %>% # Crear Porcentajes
  ggplot(aes(x=calidad_navegacion_movil, y= n, fill = calidad_navegacion_movil, label = scales::percent(pct))) +
    geom_col(binwidth = 0.5, stat = "count", colour = "black", linetype = 1) + 
    labs(x= "Calidad de navegacion movil", y= "Frecuencia", title = "Calidad de navegacion movil", subtitle = "Frecuencia de calidad de navegacion movil") +
    guides(fill = guide_legend(title = "Calidad de navegacion movil"),
           colour = guide_legend(title = "Calidad de navegacion movil")) + 
    geom_text(position = position_dodge(width = .9),    # Mover al centro de las barras
              vjust = -0.5,    # Mover al tope de las barras
              size = 3)

original_df%>%
  ggplot(aes(x = calidad_navegacion_movil, y =  fac1_ars)) +
  geom_violin() + 
  stat_summary(fun = "mean",
               geom = "point",
               aes(color = "Mean")) +
  stat_summary(fun = "median",
               geom = "point",
               aes(color = "Median")) +
 scale_colour_manual(values = c("red", "blue"))  
  #aes(x= "Ocupacion", y= "Factor 1 Redes Sociales")

original_df%>%
  ggplot(aes(x = calidad_navegacion_movil, y =  fac2_ars)) +
  geom_violin() + 
  stat_summary(fun = "mean",
               geom = "point",
               aes(color = "Mean")) +
  stat_summary(fun = "median",
               geom = "point",
               aes(color = "Median")) +
 scale_colour_manual(values = c("red", "blue"))  
  #aes(x= "Ocupacion", y= "Factor 1 Redes Sociales")

original_df%>%
  ggplot(aes(x = calidad_navegacion_movil, y =  fac3_ars)) +
  geom_violin() + 
  stat_summary(fun = "mean",
               geom = "point",
               aes(color = "Mean")) +
  stat_summary(fun = "median",
               geom = "point",
               aes(color = "Median")) +
 scale_colour_manual(values = c("red", "blue"))  
  #aes(x= "Ocupacion", y= "Factor 1 Redes Sociales")
```

#analisis univariante de percepcion positiva

```{r}
original_df %>% 
  count(navegacion_movil_positivo) %>% # Contar sujetos por municipio
  mutate(pct = prop.table(n)) %>% # Crear Porcentajes
  ggplot(aes(x=navegacion_movil_positivo, y= n, fill = navegacion_movil_positivo, label = scales::percent(pct))) +
    geom_col(binwidth = 0.5, stat = "count", colour = "black", linetype = 1) + 
    labs(x= "Percepcion positiva de la navegacion movil", y= "Frecuencia", title = "Percepcion positiva de la navegacion movil", subtitle = "Frecuencia de la percepcion positiva de la navegacion movil") +
    guides(fill = guide_legend(title = "Percepcion positiva de la navegacion movil"),
           colour = guide_legend(title = "Percepcion positiva de la navegacion movil")) + 
    geom_text(position = position_dodge(width = .9),    # Mover al centro de las barras
              vjust = -0.5,    # Mover al tope de las barras
              size = 3)

original_df%>%
  ggplot(aes(x = navegacion_movil_positivo, y =  fac1_ars)) +
  geom_violin() + 
  stat_summary(fun = "mean",
               geom = "point",
               aes(color = "Mean")) +
  stat_summary(fun = "median",
               geom = "point",
               aes(color = "Median")) +
 scale_colour_manual(values = c("red", "blue"))  
  #aes(x= "Ocupacion", y= "Factor 1 Redes Sociales")

original_df%>%
  ggplot(aes(x = navegacion_movil_positivo, y =  fac2_ars)) +
  geom_violin() + 
  stat_summary(fun = "mean",
               geom = "point",
               aes(color = "Mean")) +
  stat_summary(fun = "median",
               geom = "point",
               aes(color = "Median")) +
 scale_colour_manual(values = c("red", "blue"))  
  #aes(x= "Ocupacion", y= "Factor 1 Redes Sociales")

original_df%>%
  ggplot(aes(x = navegacion_movil_positivo, y =  fac3_ars)) +
  geom_violin() + 
  stat_summary(fun = "mean",
               geom = "point",
               aes(color = "Mean")) +
  stat_summary(fun = "median",
               geom = "point",
               aes(color = "Median")) +
 scale_colour_manual(values = c("red", "blue"))  
  #aes(x= "Ocupacion", y= "Factor 1 Redes Sociales")
```

#analisis univariante de percepcion negativa

```{r}
original_df %>% 
  count(navegacion_movil_negativo) %>% # Contar sujetos por municipio
  mutate(pct = prop.table(n)) %>% # Crear Porcentajes
  ggplot(aes(x=navegacion_movil_negativo, y= n, fill = navegacion_movil_negativo, label = scales::percent(pct))) +
    geom_col(binwidth = 0.5, stat = "count", colour = "black", linetype = 1) + 
    labs(x= "Percepcion negativa de la navegacion movil", y= "Frecuencia", title = "Percepcion negativa de la navegacion movil", subtitle = "Frecuencia de la percepcion negativa de la navegacion movil") +
    guides(fill = guide_legend(title = "Percepcion negativa de la navegacion movil"),
           colour = guide_legend(title = "Percepcion negativa de la navegacion movil")) + 
    geom_text(position = position_dodge(width = .9),    # Mover al centro de las barras
              vjust = -0.5,    # Mover al tope de las barras
              size = 3)

original_df%>%
  ggplot(aes(x = navegacion_movil_negativo, y =  fac1_ars)) +
  geom_violin() + 
  stat_summary(fun = "mean",
               geom = "point",
               aes(color = "Mean")) +
  stat_summary(fun = "median",
               geom = "point",
               aes(color = "Median")) +
 scale_colour_manual(values = c("red", "blue"))  
  #aes(x= "Ocupacion", y= "Factor 1 Redes Sociales")

original_df%>%
  ggplot(aes(x = navegacion_movil_negativo, y =  fac2_ars)) +
  geom_violin() + 
  stat_summary(fun = "mean",
               geom = "point",
               aes(color = "Mean")) +
  stat_summary(fun = "median",
               geom = "point",
               aes(color = "Median")) +
 scale_colour_manual(values = c("red", "blue"))  
  #aes(x= "Ocupacion", y= "Factor 1 Redes Sociales")

original_df%>%
  ggplot(aes(x = navegacion_movil_negativo, y =  fac3_ars)) +
  geom_violin() + 
  stat_summary(fun = "mean",
               geom = "point",
               aes(color = "Mean")) +
  stat_summary(fun = "median",
               geom = "point",
               aes(color = "Median")) +
 scale_colour_manual(values = c("red", "blue"))  
  #aes(x= "Ocupacion", y= "Factor 1 Redes Sociales")
```

#analisis descriptivo bivariante fact 1 vs calidad de internet fijo

```{r}
original_df%>%
  ggplot(aes(x = calidad_internet_fijo, y =  fac1_ars)) +
  geom_violin() + 
  stat_summary(fun = "mean",
               geom = "point",
               aes(color = "Mean")) +
  stat_summary(fun = "median",
               geom = "point",
               aes(color = "Median")) +
 scale_colour_manual(values = c("red", "blue")) 
  # aes(x= "Calidad de Internet Fijo", y= "Factor 1 Adiccion Redes Sociales")
 
```

#analisis descriptivo bivariante fact 2 vs calidad de internet fijo

```{r}
original_df%>%
  ggplot(aes(x = calidad_internet_fijo, y =  fac2_ars)) +
  geom_violin() + 
  stat_summary(fun = "mean",
               geom = "point",
               aes(color = "Mean")) +
  stat_summary(fun = "median",
               geom = "point",
               aes(color = "Median")) +
 scale_colour_manual(values = c("red", "blue")) 
  # aes(x= "Calidad de Internet Fijo", y= "Factor 2 Adiccion Redes Sociales")
```

#analisis descriptivo bivariante fact 3 vs calidad de internet fijo

```{r}
original_df%>%
  ggplot(aes(x = calidad_internet_fijo, y =  fac3_ars)) +
  geom_violin() + 
  stat_summary(fun = "mean",
               geom = "point",
               aes(color = "Mean")) +
  stat_summary(fun = "median",
               geom = "point",
               aes(color = "Median")) +
 scale_colour_manual(values = c("red", "blue")) 
  # aes(x= "Calidad de Internet Fijo", y= "Factor 3 Adiccion Redes Sociales")
```
